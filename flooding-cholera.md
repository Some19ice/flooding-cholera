Product Requirement Document (PRD)Integrated Cholera Environmental Surveillance System (v2.0 - Real-Time & Interactive)Date: October 26, 2023Status: DraftVersion: 2.01. Executive SummaryThe Integrated Cholera Environmental Surveillance System v2.0 is an evolution of the static dashboard prototype into a dynamic, full-stack web application. It aims to provide real-time epidemiological and environmental monitoring for Cross River State, Nigeria.Key Enhancements:Real-Time Data Integration: Automated fetching of satellite (environmental) and health facility (epidemiological) data.Granular Search: Deep-dive analytics per Local Government Area (LGA).User Data Upload: Ability for authorized health workers to upload local datasets (CSV/JSON), triggering instant risk model recalculations.2. User StoriesAs a State Epidemiologist, I want to search for specific LGAs (e.g., "Obubra") to see current risk levels, case counts, and flood indices isolated from the state view.As a Field Data Officer, I want to upload a CSV of this week's case numbers from rural clinics so that the system updates the risk maps immediately without waiting for central processing.As a Researcher, I want to compare uploaded local rainfall data against satellite estimates to validate the flood prediction model.As an Emergency Responder, I want to receive real-time alerts when new data inputs push an LGA from "Yellow" to "Red" alert levels.3. Functional Requirements3.1. Real-Time Data IntegrationThe system must aggregate data from three primary streams:Epidemiological API: Connection to DHIS2 (District Health Information Software) or Nigeria CDC API for reported cases.Environmental API: * NASA GPM (Global Precipitation Measurement) for rainfall.Google Earth Engine API for Sentinel-1 (Flood Extent/NDWI) and MODIS (LST).Social/News API: Scraping local news or social media for keywords like "diarrhea", "flood", "river rising" (optional sentiment analysis).3.2. LGA Search & Drill-Down ModuleSearch Bar: Global search bar with autocomplete for all 18 Cross River State LGAs.LGA Dashboard View: Upon selection, the view transforms to show:A dedicated map of the specific LGA.Specific population-at-risk calculations.List of specific wards/communities within the LGA flagged as hotspots.Local healthcare facility status (Active/Overwhelmed).3.3. Data Upload & Recalculation EngineUpload Interface: Drag-and-drop zone accepting .csv, .xlsx, and .json.Schema Validation: System must check for required columns: date, lga_name, cases, rainfall_mm (optional), water_source_status (optional).Recalculation Logic: * If user data overlaps with system data, user data takes precedence (or acts as "Ground Truth").Trigger: Upon upload, the Risk Score Algorithm runs immediately.Output: "Pre-upload" vs. "Post-upload" comparison view, highlighting changes in Risk Level (e.g., Green -> Yellow).3.4. Export & ReportingGenerate PDF Situation Reports (SITREPs) automatically based on the current view (LGA or State).Export cleaned datasets as CSV for offline analysis.4. Technical Architecture4.1. Tech StackFrontend: React.js (Vite), Tailwind CSS, Recharts (Visualization), Mapbox GL JS or Leaflet (Geospatial visualization).Backend: Python (FastAPI or Django) or Node.js. Python is preferred for geospatial libraries (geopandas, rasterio) and data science support.Database: PostgreSQL with PostGIS extension (crucial for spatial queries and polygon mapping of LGAs).Data Processing: Apache Airflow or Celery for scheduling satellite data retrieval jobs.4.2. Risk Modeling Algorithm (The "Recalculator")The core logic residing on the server (accessible via /api/calculate-risk).def calculate_risk_score(lga_data):
    # Weights based on PRD v1.0 findings
    W_FLOOD = 0.4
    W_RAIN = 0.2
    W_CASES = 0.3
    W_VULNERABILITY = 0.1

    # Normalize inputs (0-1 scale)
    norm_flood = normalize(lga_data.ndwi)
    norm_rain = normalize(lga_data.rainfall)
    norm_cases = normalize(lga_data.recent_cases)

    # Calculate Score
    risk_score = (norm_flood * W_FLOOD) + 
                 (norm_rain * W_RAIN) + 
                 (norm_cases * W_CASES) + 
                 (lga_data.vulnerability_index * W_VULNERABILITY)
    
    return risk_score
5. Data Specifications5.1. CSV Upload TemplateUsers must follow this structure for valid uploads:DateLGAWardNew_CasesDeathsRainfall_mmFlood_Observed2024-08-01ObubraOwakande5045.2Yes2024-08-01IkomIkom Urban12150.1Yes5.2. API Endpoints StrategyGET /api/lgas: List all LGAs and their metadata (geojson, population).GET /api/lgas/{id}/analytics: Get time-series data for charts.POST /api/upload: Endpoint for multipart/form-data (CSV upload). Returns the Recalculated State.GET /api/satellite/latest: Fetches the most recent satellite pass data for the region.6. UI/UX Design Requirements6.1. Search ExperienceSearch input should exist in the top navigation bar.Typing "Ob" should suggest "Obubra", "Obanlikwu", "Obudu".Selecting an LGA zooms the map viewport to that polygon bounds.6.2. Upload Feedback LoopAction: User uploads week_34_data.csv.State: Loading spinner with text "Validating schema..." -> "Recalculating Risk Models...".Result: Success toast. Dashboard refreshes.Visual Cue: Charts show a dotted line ("Previous Model") vs solid line ("Updated with User Data").6.3. Interactive MapChoropleth map colored by Risk Level.Hovering over an LGA shows a tooltip with: "Risk: High", "Cases: 12", "Last Updated: 2h ago".Clicking an LGA triggers the Search/Filter action for that LGA.7. Security & PrivacyAuthentication: OAuth 2.0 (Login for authorized health workers to upload data). Public users have read-only access to aggregated data.Anonymization: Uploaded CSVs containing patient names or exact addresses must be rejected or scrubbed server-side. Only aggregate case counts per Ward/LGA are stored.Audit Logs: Track who uploaded data and when, to prevent malicious skewing of risk models.8. Implementation RoadmapPhase 1: MVP (Months 1-2)Static map converted to interactive Leaflet/Mapbox map.LGA Search & Filtering logic implementation.Database setup (PostGIS) with seed data.Phase 2: Dynamic Data (Months 3-4)Build Python backend for Satellite API integration.Implement CSV Upload & Parsing logic.Develop the Risk Calculation Engine.Phase 3: Real-Time & Alerts (Months 5-6)Automated satellite fetch cron jobs.Email/SMS Alerting system based on thresholds.User Management & RBAC (Role-Based Access Control).